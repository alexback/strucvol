}
test <- simstrucsystem()
plot(test$lm, type = "l")
plot(test$re, type = "l")
plot(test$retseries[,2], type = "l")
plot(test$lm, type = "l")
library(strucvol)
plot(test$E - test$A, type = "l")
devtools::document()
devtools::build_manual()
simstrucsystem <- function(len = 2000, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 100, Ein = 80, K = 20, r = 0.001, uv = 0.0005, ttv = 5)
{
mu1 <- pars[1]
beta1 <- pars[2]
sigma1 <- pars[3]
mu2 <- pars[4]
beta2 <- pars[5]
sigma2 <- pars[6]
rho <- pars[7]
len <- as.integer(len)
h_1 <- rep_len(0, length.out = len)
h_2 <- rep_len(0, length.out = len)
h0_1 <- rnorm(1, mean = mu1, sd = sigma1 / sqrt(1 - beta1^2))
h0_2 <- rnorm(1, mean = mu2, sd = sigma2 / sqrt(1 - beta2^2))
eta1 <- rnorm(len)
eta2 <- rnorm(len)
sigmaeps <- matrix(c(1, rho, rho, 1), byrow = T, ncol = 2, nrow = 2)
eps <- mvrnorm(n = len, mu = c(0,0), Sigma = sigmaeps)
eps1 <- eps[,1]
eps2 <- eps[,2]
h_1[1] <- mu1 + beta1 * (h0_1 - mu1) + sigma1 * eta1[1]  # Initialize
h_2[1] <- mu2 + beta2 * (h0_2 - mu2) + sigma2 * eta2[1]  # Initialize
for (i in 2:length(h_1)){
h_1[i] <- mu1 + beta1 * (h_1[i-1] - mu1) + sigma1 * eta1[i]
h_2[i] <- mu2 + beta2 * (h_2[i-1] - mu2) + sigma2 * eta2[i]
}
ra <- exp(h_1 / 2) * eps1
rm <- exp(h_2 / 2) * eps2
A <- cumprod(c(Ain, exp(ra)))
AK <- A / K
d1 <- (log(AK) + (r + 0.5 * sqrt(uv * 252)^2 ) * ttv) / (sqrt(uv * 252 * ttv))
E <- rep(0,len)
E[1] <- Ein
lm <- rep(0, len-1)
re <- rep(0, len)
re[1] <- ra[1]
for (j in 2:len){
lm[j -1] <- pnorm(d1[j -1]) * A[j - 1] / E[j - 1]
re[j] <- lm[j -1] * ra[j]
E[j] <- E[j - 1] * exp(re[j])
}
EK = E / K
return(list(retseries = cbind(ra, re, rm),h = cbind(h_1, h_2) lm = lm, E = E, A = A, EK = EK))
simstrucsystem <- function(len = 2000, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 100, Ein = 80, K = 20, r = 0.001, uv = 0.0005, ttv = 5)
{
mu1 <- pars[1]
beta1 <- pars[2]
sigma1 <- pars[3]
mu2 <- pars[4]
beta2 <- pars[5]
sigma2 <- pars[6]
rho <- pars[7]
len <- as.integer(len)
h_1 <- rep_len(0, length.out = len)
h_2 <- rep_len(0, length.out = len)
h0_1 <- rnorm(1, mean = mu1, sd = sigma1 / sqrt(1 - beta1^2))
h0_2 <- rnorm(1, mean = mu2, sd = sigma2 / sqrt(1 - beta2^2))
eta1 <- rnorm(len)
eta2 <- rnorm(len)
sigmaeps <- matrix(c(1, rho, rho, 1), byrow = T, ncol = 2, nrow = 2)
eps <- mvrnorm(n = len, mu = c(0,0), Sigma = sigmaeps)
eps1 <- eps[,1]
eps2 <- eps[,2]
h_1[1] <- mu1 + beta1 * (h0_1 - mu1) + sigma1 * eta1[1]  # Initialize
h_2[1] <- mu2 + beta2 * (h0_2 - mu2) + sigma2 * eta2[1]  # Initialize
for (i in 2:length(h_1)){
h_1[i] <- mu1 + beta1 * (h_1[i-1] - mu1) + sigma1 * eta1[i]
h_2[i] <- mu2 + beta2 * (h_2[i-1] - mu2) + sigma2 * eta2[i]
}
ra <- exp(h_1 / 2) * eps1
rm <- exp(h_2 / 2) * eps2
A <- cumprod(c(Ain, exp(ra)))
AK <- A / K
d1 <- (log(AK) + (r + 0.5 * sqrt(uv * 252)^2 ) * ttv) / (sqrt(uv * 252 * ttv))
E <- rep(0,len)
E[1] <- Ein
lm <- rep(0, len-1)
re <- rep(0, len)
re[1] <- ra[1]
for (j in 2:len){
lm[j -1] <- pnorm(d1[j -1]) * A[j - 1] / E[j - 1]
re[j] <- lm[j -1] * ra[j]
E[j] <- E[j - 1] * exp(re[j])
}
EK = E / K
return(list(retseries = cbind(ra, re, rm),h = cbind(h_1, h_2), lm = lm, E = E, A = A, EK = EK))
}
test <- simstrucsystem()
plot(test$h[,1], type = "l")
par(mfrow = c(1,1))
plot(test$h[,1], type = "l")
mean(test$h[,1])
mean(test$h[,2])
plot(test$h[,2], type = "l")
sims <- replicate(n = 1000, simstrucsystem(len = 100))
sims <- replicate(n = 1000, simstrucsystem(len = 100)$EK)
hist(sims)
ggplot(sims) +
geom_histogram(fill= 'light blue', bins = 20) +
geom_vline(aes(xintercept= 1))
library("ggplot2")
ggplot(sims) +
geom_histogram(fill= 'light blue', bins = 20) +
geom_vline(aes(xintercept= 1))
ggplot(data.frame(sims)) +
geom_histogram(fill= 'light blue', bins = 20) +
geom_vline(aes(xintercept= 1))
ggplot(data.frame(sims), aes(x = sims)) +
geom_histogram(fill= 'light blue', bins = 20) +
geom_vline(aes(xintercept= 1))
ggplot(data.frame(sims), aes(x = sims[,1])) +
geom_histogram(fill= 'light blue', bins = 20) +
geom_vline(aes(xintercept= 1))
ggplot(data.frame(sims), aes(x = sims[,1])) +
geom_histogram(fill= 'light blue', bins = 20) +
geom_vline(aes(xintercept= 4))
ggplot(data.frame(sims), aes(x = sims[,1])) +
geom_histogram(fill= 'light blue', bins = 10) +
geom_vline(aes(xintercept= 4))
simdevent <- function(N, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 100, Ein = 80, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 30){
sims <- simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)
plot <-  ggplot(data.frame(sims), aes(x = sims[,1])) +
geom_histogram(fill= 'light blue', bins = 10) +
geom_vline(aes(xintercept= default))
return(list(sims = sims, plot = plot))
}
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 30){
sims <- simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)
plot <-  ggplot(data.frame(sims), aes(x = sims[,1])) +
geom_histogram(fill= 'light blue', bins = 10) +
geom_vline(aes(xintercept= default))
return(list(sims = sims, plot = plot))
}
simtest <- simdevent(N = 10000)
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 30){
sims <- replicate(n = N,
simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK)
plot <-  ggplot(data.frame(sims), aes(x = sims[,1])) +
geom_histogram(fill= 'light blue', bins = 10) +
geom_vline(aes(xintercept= default))
return(list(sims = sims, plot = plot))
}
simtest <- simdevent(N = 10000)
simtest$plot
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 1.2){
sims <- replicate(n = N,
simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK)
plot <-  ggplot(data.frame(sims), aes(x = sims[,1])) +
geom_histogram(fill= 'light blue', bins = 10) +
geom_vline(aes(xintercept= default))
return(list(sims = sims, plot = plot))
}
simtest <- simdevent(N = 10000)
simtest$plot
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 3){
sims <- replicate(n = N,
simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK)
plot <-  ggplot(data.frame(sims), aes(x = sims[,1])) +
geom_histogram(fill= 'light blue', bins = 10) +
geom_vline(aes(xintercept= default))
return(list(sims = sims, plot = plot))
}
simtest <- simdevent(N = 10000)
simtest$plot
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 3){
sims <- replicate(n = N,
simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK)
plot <-  ggplot(data.frame(sims), aes(x = sims[,1])) +
geom_histogram(fill= 'light blue', bins = 20) +
geom_vline(aes(xintercept= default))
return(list(sims = sims, plot = plot))
}
simtest <- simdevent(N = 10000)
simtest$plot
sims <- replicate(n = 10000, simstrucsystem(len = 252)$EK)
hist(sims)
hist(sims, probability = T)
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 3){
sims <- replicate(n = N,
simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK)
plot <-  ggplot(data.frame(sims), aes(x = sims[,1])) +
geom_histogram(fill= 'light blue', binwidth = 1) +
geom_vline(aes(xintercept= default))
return(list(sims = sims, plot = plot))
}
simtest <- simdevent(N = 10000)
simtest$plot
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 3){
sims <- replicate(n = N,
simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK)
plot <-  ggplot(data.frame(sims), aes(x = sims[,1])) +
geom_histogram(fill= 'light blue', binwidth = 1, bins = 20) +
geom_vline(aes(xintercept= default))
return(list(sims = sims, plot = plot))
}
simtest <- simdevent(N = 10000)
simtest$plot
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 3){
sims <- replicate(n = N,
simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK)
plot <-  ggplot(data.frame(sims), aes(x = sims[,1])) +
geom_histogram(fill= 'light blue', binwidth = 3) +
geom_vline(aes(xintercept= default))
return(list(sims = sims, plot = plot))
}
simtest <- simdevent(N = 10000)
simtest$plot
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 3){
sims <- replicate(n = N,
simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK)
plot <-  ggplot(data.frame(sims), aes(x = sims[,1])) +
geom_histogram(fill= 'light blue', bins = 30) +
geom_vline(aes(xintercept= default))
return(list(sims = sims, plot = plot))
}
simtest <- simdevent(N = 10000)
simtest$plot
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 3){
sims <- replicate(n = N,
simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK)
plot <-  ggplot(data.frame(sims), aes(x = sims[,1])) +
geom_histogram(fill= 'light blue', bins = 50) +
geom_vline(aes(xintercept= default))
return(list(sims = sims, plot = plot))
}
simtest <- simdevent(N = 10000)
simtest$plot
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 3){
sims <- replicate(n = N,
simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK)
plot <-  ggplot(data.frame(sims), aes(x = sims[,1])) +
geom_histogram(fill= 'light blue', bins = 50) #+
# geom_vline(aes(xintercept= default))
return(list(sims = sims, plot = plot))
}
simtest <- simdevent(N = 10000)
simtest$plot
simtest <- simdevent(N = 10000)
simtest$plot
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 3){
sims <- replicate(n = N,
simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK)
hist(sims)
abline(v = default)
return(list(sims = sims, plot = plot))
}
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 3){
sims <- replicate(n = N,
simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK)
hist(sims)
abline(v = default)
return(sims)
}
simtest <- simdevent(N = 10000)
5e05
10^e2
10^e+2
10e+2
10e+02
10e+05
1e+06
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 3){
sims <- replicate(n = N,
simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK[252])
hist(sims)
abline(v = default)
return(sims)
}
simtest <- simdevent(N = 10000)
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 3){
sims <- replicate(n = N,
min(simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK))
hist(sims)
abline(v = default)
return(sims)
}
simtest <- simdevent(N = 10000)
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 50, Ein = 60, K = 20, r = 0.001, uv = 0.0005, ttv = 5, default = 2){
sims <- replicate(n = N,
min(simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK))
hist(sims)
abline(v = default)
return(sims)
}
simtest <- simdevent(N = 10000)
1/150
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 80, Ein = 60, K = 60, r = 0.001, uv = 0.0005, ttv = 5, default = 2){
sims <- replicate(n = N,
min(simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK))
hist(sims)
abline(v = default)
return(sims)
}
simtest <- simdevent(N = 10000)
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 80, Ein = 60, K = 60, r = 0.001, uv = 0.0005, ttv = 5, default = 0.2){
sims <- replicate(n = N,
min(simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK))
hist(sims)
abline(v = default)
return(sims)
}
simtest <- simdevent(N = 10000)
test <- simstrucsystem()
plot(test$EK, type = "l")
test <- simstrucsystem()
plot(test$EK, type = "l")
test <- simstrucsystem()
plot(test$EK, type = "l")
plot(test$h_1, type = "l")
plot(test$h[,1], type = "l")
plot(test$h[,2], type = "l")
plot(test$lm, type = "l")
plot(test$EK, type = "l")
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 80, Ein = 60, K = 60, r = 0.001, uv = 0.0005, ttv = 5, default = 0.2){
sims <- replicate(n = N,
min(simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK))
hist(sims, main = "Distribution of the minimum leverage ratio during the period", xlab = "Leverage ratio", col = 3,      # Color
density = 20,
angle = 20)
abline(v = default)
return(sims)
}
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 80, Ein = 60, K = 60, r = 0.001, uv = 0.0005, ttv = 5, default = 0.2){
sims <- replicate(n = N,
min(simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK))
hist(sims, main = "Distribution of the minimum leverage ratio during the period", xlab = "Leverage ratio", col = 3,      # Color
density = 20,
angle = 20)
abline(v = default, col = "red")
return(sims)
}
simtest <- simdevent(N = 10000)
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 80, Ein = 60, K = 60, r = 0.001, uv = 0.0005, ttv = 5, default = 0.5){
sims <- replicate(n = N,
min(simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK))
hist(sims, main = "Distribution of the minimum leverage ratio during the period", xlab = "Leverage ratio", col = 5,      # Color
density = 20,
angle = 20)
abline(v = default, col = "red")
return(sims)
}
simtest <- simdevent(N = 10000)
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 80, Ein = 60, K = 60, r = 0.001, uv = 0.0005, ttv = 5, default = 0.5){
sims <- replicate(n = N,
min(simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK))
hist(sims, main = "Distribution of the minimum leverage ratio during the period", xlab = "Leverage ratio", col = 5,      # Color
density = 20,
angle = 20)
abline(v = default)
return(sims)
}
simtest <- simdevent(N = 10000)
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 80, Ein = 60, K = 60, r = 0.001, uv = 0.0005, ttv = 5, default = 0.5){
sims <- replicate(n = N,
min(simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK))
hist(sims, main = "Distribution of the minimum leverage ratio during the period", xlab = "Leverage ratio", col = 5,      # Color
density = 20,
angle = 20)
abline(v = 0.5)
return(sims)
}
simtest <- simdevent(N = 10000)
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 80, Ein = 60, K = 60, r = 0.001, uv = 0.0005, ttv = 5, default = 0.5){
sims <- replicate(n = N,
min(simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK))
hist(sims, main = "Distribution of the minimum leverage ratio during the period", xlab = "Leverage ratio",# col = 5,      # Color
#density = 20,
#angle = 20
)
abline(v = 0.5, col ="red")
return(sims)
}
simtest <- simdevent(N = 10000)
abline(v = 0.5, col = "red")
dev.off()
simtest <- simdevent(N = 10000)
abline(v = 0.5, col = "red")
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 80, Ein = 60, K = 60, r = 0.001, uv = 0.0005, ttv = 5, default = 0.5){
sims <- replicate(n = N,
min(simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK))
hist(sims, main = "Distribution of the minimum leverage ratio during the period", xlab = "Leverage ratio",# col = 5,      # Color
#density = 20,
#angle = 20
)
abline(v = 0.7, col ="red")
return(sims)
}
simtest <- simdevent(N = 10000)
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 80, Ein = 60, K = 60, r = 0.001, uv = 0.0005, ttv = 5, default = 0.8){
sims <- replicate(n = N,
min(simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK))
hist(sims, main = "Distribution of the minimum leverage ratio during the period", xlab = "Leverage ratio", col = 5,      # Color
density = 20,
angle = 20
)
abline(v = default, col ="red")
return(sims)
}
simtest <- simdevent(N = 10000)
?abline
simdevent <- function(N = 1000, len = 252, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 80, Ein = 60, K = 60, r = 0.001, uv = 0.0005, ttv = 5, default = 0.8){
sims <- replicate(n = N,
min(simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK))
hist(sims, main = "Distribution of the minimum leverage ratio during the period", xlab = "Leverage ratio", col = 5,      # Color
density = 20,
angle = 20
)
abline(v = default, col ="red")
legend("topleft", legend = "Default", pch = "|", col = "red")
return(sims)
}
simtest <- simdevent(N = 10000)
max(simtest)
min(simtest)
quantile(simtest, 0.95)
quantile(simtest, 0.05)
simdevent <- function(N = 1000, len = 500, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 80, Ein = 60, K = 60, r = 0.001, uv = 0.0005, ttv = 5, default = 0.8){
sims <- replicate(n = N,
min(simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK))
hist(sims, main = "Distribution of the minimum leverage ratio during the period", xlab = "Leverage ratio", col = 5,      # Color
density = 20,
angle = 20
)
abline(v = default, col ="red")
legend("topleft", legend = "Default", pch = "|", col = "red")
return(sims)
}
simtest <- simdevent(N = 10000)
simdevent <- function(N = 1000, len = 500, pars = c(-10, 0.95, 0.3, -12, 0.9, 0.2, 0.9),
Ain = 80, Ein = 60, K = 60, r = 0.001, uv = 0.0005, ttv = 5, default = 0.8){
sims <- replicate(n = N,
min(simstrucsystem(len = len, pars = pars, Ain = Ain, Ein = Ein, K = K, r = r, uv = uv, ttv = ttv)$EK))
hist(sims, main = "Distribution of the minimum leverage ratio during the period", xlab = "Leverage ratio", col = 5,
angle = 20)
abline(v = default, col ="red")
legend("topleft", legend = "Default", pch = "|", col = "red")
return(sims)
}
test <- simdevent(N = 10000)
hist(test)
devtools::document()
rm(list = c("simstrucsystem"))
devtools::document()
rm(list = c("simdevent"))
devtools::document()
?simdevent
library(strucvol)
?simdevent()
devtools::document()
devtools::build_manual()
library(strucvol)
library(strucvol)
library(strucvol)
detach("package:strucvol", unload = T)
detach("strucvol", unload = T)
detach("package::strucvol", unload = T)
detach("package:strucvol", unload = T)
detach_package <- function(pkg, character.only = FALSE)
{
if(!character.only)
{
pkg <- deparse(substitute(pkg))
}
search_item <- paste("package", pkg, sep = ":")
while(search_item %in% search())
{
detach(search_item, unload = TRUE, character.only = TRUE)
}
}
detach_package("strucvol")
detach_package("strucvol")
